type t = Node (t,t)

erase1 (x:t) : t = rewrite x {
  | Node(Node (x, a),b) -> x
}
(*EXPECT
erase1 (x : t) : t = rewrite x {
  | (a:t | .t@0.t@1.φ^k₀ → ø)
    (b:t | .t@1.φ^k₁ → ø)
    (x[]:t | (.t@0.t@0)^(k₂ + 1) → (.t@0.t@0)^k₂)
    (x.t@0:t | (.t@0.t@0)^(k₂ + 1).t@0 → (.t@0.t@0)^k₂.t@0)
    (x.t@1:t |
     (.t@0.t@0)^(k₂ + 1).t@1.φ^k₃ →
     (.t@0.t@0)^k₂.t@1.φ^k₃)
    (x.t@0.t@1:t |
     (.t@0.t@0)^(k₂ + 1).t@0.t@1.φ^k₄ →
     (.t@0.t@0)^k₂.t@0.t@1.φ^k₄)
}

*)

erase2 (x:t) : t = rewrite x {
  | Node(Node (Node(x1,x2), a),b) -> Node(x1,x2)
}
(*EXPECT

erase2 (x : t) : t = rewrite x {
  | (a:t | .t@0.t@1.φ^k₅ → ø)
    (b:t | .t@1.φ^k₆ → ø)
    (x1[]:t | .t@0(.t@0.t@0)^(k₇ + 1) → .t@0(.t@0.t@0)^k₇)
    (x1.t@0:t | .t@0(.t@0.t@0)^(k₇ + 1).t@0 → .t@0(.t@0.t@0)^k₇.t@0)
    (x1.t@1:t |
     .t@0(.t@0.t@0)^(k₇ + 1).t@1.φ^k₈ →
     .t@0(.t@0.t@0)^k₇.t@1.φ^k₈)
    (x1.t@0.t@1:t |
     .t@0(.t@0.t@0)^(k₇ + 1).t@0.t@1.φ^k₉ →
     .t@0(.t@0.t@0)^k₇.t@0.t@1.φ^k₉)
    (x2:t | .t@0.t@0.t@1.φ^k₁₀ → .t@1.φ^k₁₀)
}

*)

erase3 (x:t) : t = rewrite x {
  | Node(Node (Node(Node(x1,x2),x3), a),b) -> Node(Node(x1,x2),x3)
}
(*EXPECT

erase3 (x : t) : t = rewrite x {
  | (a:t | .t@0.t@1.φ^k₁₁ → ø)
    (b:t | .t@1.φ^k₁₂ → ø)
    (x1[]:t | (.t@0.t@0)^(k₁₃ + 2) → (.t@0.t@0)^(k₁₃ + 1))
    (x1.t@0:t | (.t@0.t@0)^(k₁₃ + 2).t@0 → (.t@0.t@0)^(k₁₃ + 1).t@0)
    (x1.t@1:t |
     (.t@0.t@0)^(k₁₃ + 2).t@1.φ^k₁₄ →
     (.t@0.t@0)^(k₁₃ + 1).t@1.φ^k₁₄)
    (x1.t@0.t@1:t |
     (.t@0.t@0)^(k₁₃ + 2).t@0.t@1.φ^k₁₅ →
     (.t@0.t@0)^(k₁₃ + 1).t@0.t@1.φ^k₁₅)
    (x2:t | .t@0.t@0.t@0.t@1.φ^k₁₆ → .t@0.t@1.φ^k₁₆)
    (x3:t | .t@0.t@0.t@1.φ^k₁₇ → .t@1.φ^k₁₇)
}

*)

